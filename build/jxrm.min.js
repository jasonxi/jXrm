/*! jxrm 2020-01-29 */
/*! https://github.com/jasonxi/jXrm */

!function(){var e,t,n,i,r,s,a,u,o,f;function c(){this.items=[]}function l(e){return r.getFormContext(e).context}function g(){return Xrm.Utility.getGlobalContext()}function d(t,e,n){s.getFormContext(e).ui.controls.get().forEach(function(e){(!t||t.indexOf(e.getName())<0)&&e.setDisabled&&e.setDisabled(n)})}function h(e,t,n){var i=s.getFormContext(t).ui.tabs.get(e);i&&i.setVisible(n)}function m(e,t,n,i){var r=s.getFormContext(n).ui.tabs.get(e);if(r){var o=r.sections.get(t);o&&o.setVisible(i)}}"undefined"==typeof Xrm&&(window.Xrm={__namespace:!0}),Xrm,e=function(){var e="[\\x20\\t\\r\\n\\f]",t="(?:\\\\[\\da-fA-F]{1,6}"+e+"?|\\\\[^\\r\\n\\f]|[\\w-]|[^\0-\\x7f])+",n="\\["+e+"*("+t+")(?:"+e+"*([*^$|!~]?=)"+e+"*(?:'((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\"|("+t+"))|)"+e+"*\\]",r=(new RegExp(e+"+","g"),new RegExp("^"+e+"+|((?:^|[^\\\\])(?:\\\\.)*)"+e+"+$","g")),o=(new RegExp("^"+e+"*,"+e+"*"),new RegExp("^"+e+"*([>+~]|"+e+")"+e+"*"),new RegExp(e+"|>"),new RegExp(":((?:\\\\[\\da-fA-F]{1,6}[\\x20\\t\\r\\n\\f]?|\\\\[^\\r\\n\\f]|[\\w-]|[^\0-\\x7f])+)(?:\\((('((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\")|((?:\\\\.|[^\\\\()[\\]]|\\[[\\x20\\t\\r\\n\\f]*((?:\\\\[\\da-fA-F]{1,6}[\\x20\\t\\r\\n\\f]?|\\\\[^\\r\\n\\f]|[\\w-]|[^\0-\\x7f])+)(?:[\\x20\\t\\r\\n\\f]*([*^$|!~]?=)[\\x20\\t\\r\\n\\f]*(?:'((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\"|((?:\\\\[\\da-fA-F]{1,6}[\\x20\\t\\r\\n\\f]?|\\\\[^\\r\\n\\f]|[\\w-]|[^\0-\\x7f])+))|)[\\x20\\t\\r\\n\\f]*\\])*)|.*)\\)|)"),new RegExp("^"+t+"$"),{ID:new RegExp("^#("+t+")"),TAG:new RegExp("^%("+t+")"),SECTION:new RegExp("^$("+t+")"),CLASS:new RegExp("^\\.("+t+")"),ATTR:new RegExp("^"+n)});new RegExp("\\\\[\\da-fA-F]{1,6}"+e+"?|\\\\([^\\r\\n\\f])","g");return{parse:function(e,t){var n,i=[];return null!=e&&""!=e&&e.split(",").forEach(function(e){for(var t in e=e.replace(r,""),o)if(n=o[t].exec(e)){i.push({type:t,value:n.shift(),id:n.shift().toLowerCase()});break}}),i}}}(),c.prototype={exec:function(t){if(0===this.items.length||!t)return null;if(1===this.items.length&&t)return t(this.items[0]);if(1<this.items.length&&t){var n={};return this.items.forEach(function(e){n[e.getName()]=t(e)}),n}},push:function(e){this.items.push(e)},get first(){return 0<this.items.length?this.items[0]:null},get length(){return this.items.length}},n=function(e,s,a,t){"undefined"==typeof jXrm&&(jXrm={__namespace:!0});function u(e){return e&&e.getFormContext?e.getFormContext():jXrm.formContext||Xrm.Page}function n(e,t){var n=this.attributes=new a,i=this.controls=new a,r=u(t),o=s.parse(e);0<o.length?o.forEach(function(e){switch(e.type){case"ID":n.push(r.getAttribute(e.id)),i.push(r.getControl(e.id))}}):console.log("Invalid selector.")}return jXrm=function(e,t){return new n(e,t)},jXrm.fn0=n.prototype={},jXrm.fn=jXrm.prototype={version:"0.03"},t.extend(jXrm,{getFormContext:u,set executionContext(e){jXrm.formContext=u(e)},enum:{}}),jXrm}(0,e,c,t={extend:function(e,t){"function"!=typeof Object.assign&&(Object.assign=function(e,t){"use strict";if(null==e)throw new TypeError("Cannot convert undefined or null to object");for(var n=Object(e),i=1;i<arguments.length;i++){var r=arguments[i];if(null!=r)for(var o in r)Object.prototype.hasOwnProperty.call(r,o)&&(n[o]=r[o])}return n}),Object.assign(e,t)},toObject:function(t,e){return t=t||{},e.forEach(function(e){if(null!==e){var i=e.split("|");i[1]||(i[1]=i[0]),t[i[0]]=function(){for(var e="a"===i[2]?this.attributes:this.controls,t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];if(i[4]&&(t[0]="1"===i[4]||"0"!==i[4]&&i[4]),e)return i[3]?e.exec(function(e){return e&&e[i[1]]?e[i[1]].apply(e,t):null}):(e.exec(function(e){e&&e[i[1]]&&e[i[1]].apply(e,t)}),this)}}}),t}}),i={AlertOpts:{width:450,height:150},ConfirmOpts:{width:450,height:200}},(r=n).context={getUserId:function(e){return l(e).getUserId()},getUserName:function(e){return l(e).getUserName()},getUserRoles:function(e){return l(e).getUserRoles()},getClientUrl:function(){return g().getClientUrl()},get isOffline(){return g().client.isOffline()}},function(e,t){t.extend(e.enum,{RequiredLevel:{None:"none",Required:"required",Recommended:"recommended"},SubmitMode:{Always:"always",Never:"never",Dirty:"dirty"}});t.toObject(e.fn0,["getType|getAttributeType|a|1","isDirty|getIsDirty|a|1","isPartyList|getIsPartyList|a|1","isValid||a|1","maxLength|getMaxLength|a|1","getRequiredLevel||a|1","setRequiredLevel||a","required|setRequiredLevel|a||required","recommended|setRequiredLevel|a||recommended","optional|setRequiredLevel|a||none","getSubmitMode||a|1","setSubmitMode||a","getVisible||c|1","setVisible||c","show|setVisible|c||1","hide|setVisible|c||0","parent|getParent|a|1","getPrivilege|getUserPrivilege|a|1","change|addOnChange|a","removeOnChange||a","fireOnChange||a","getOption||a|1","getOptions||a|1","disable|setDisabled|c||1","enable|setDisabled|c||0","addCustomFilter||c","addPreSearch||c","removePreSearch||c"]),t.extend(e.fn0,{val:function(t,n){return void 0===t?this.attributes.exec(function(e){return e&&e.getValue?e.getValue():null}):(this.attributes.exec(function(e){e&&e.setValue&&e.setValue(t),!0===n&&e.fireOnChange()}),this)},focus:function(){return this.controls.first&&this.controls.first.setFocus&&this.controls.first.setFocus(),this},toggleVisible:function(){return this.controls.exec(function(e){e&&e.setVisible&&e.setVisible(!e.getVsible())}),this},on:function(e,t){},filter:function(t,n){return this.controls.exec(function(e){e&&e.addPreSearch&&e.addPreSearch(function(){e.addCustomFilter(n,t)})}),this}})}(n,t),u=i,(a=t).extend(s=n,{alert:function(e,t,n,i){var r="string"==typeof e?{text:e}:e,o=u.AlertOpts;a.extend(o,i),Xrm.Navigation.openAlertDialog(r,o).then(t,n)},confirm:function(e,t,n,i,r){var o="string"==typeof e?{text:e}:e,s=u.ConfirmOpts;a.extend(s,r),Xrm.Navigation.openConfirmDialog(o,s).then(function(e){e.confirmed&&(t?t():n&&n())},i)},openForm:function(e,t,n,i,r,o){var s={entityName:e,entityId:t};o&&a.extend(s,o),Xrm.Navigation.openForm(s,n).then(i,r)},openFile:function(e,t){Xrm.Navigation.openFile(e,t)},openUrl:function(e,t){Xrm.Navigation.openUrl(e,t)},openWebResource:function(e,t,n){Xrm.Navigation.openWebResource(e,t,n)},disableForm:function(e,t){d(e,t,!0)},enableForm:function(e,t){d(e,t,!1)},showTab:function(e,t){h(e,t,!0)},hideTab:function(e,t){h(e,t,!1)},showSection:function(e,t,n){m(e,t,n,!0)},hideSection:function(e,t,n){m(e,t,n,!1)}}),t.extend(o=n,{save:function(e,t,n){return o.getFormContext(n).data.save().then(e,t),this},refresh:function(e,t,n,i){return o.getFormContext(i).data.refresh(e).then(t,n),this},addOnLoad:function(e,t){return o.getFormContext(t).data.addOnLoad(e),this}}),f=n,window.jXrm=f}();