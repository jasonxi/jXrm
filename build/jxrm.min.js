/*! jxrm 2020-01-16 */
/* https://github.com/jasonxi/jXrm
!function(){var e,t,n,r,i,o,a,u,s,f;function c(){this.items=[]}function l(){return Xrm.Page.context}function g(){return Xrm.Utility.getGlobalContext()}"undefined"==typeof Xrm&&(window.Xrm={__namespace:!0}),Xrm,e=function(){var e="[\\x20\\t\\r\\n\\f]",t="(?:\\\\[\\da-fA-F]{1,6}"+e+"?|\\\\[^\\r\\n\\f]|[\\w-]|[^\0-\\x7f])+",n="\\["+e+"*("+t+")(?:"+e+"*([*^$|!~]?=)"+e+"*(?:'((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\"|("+t+"))|)"+e+"*\\]",i=(new RegExp(e+"+","g"),new RegExp("^"+e+"+|((?:^|[^\\\\])(?:\\\\.)*)"+e+"+$","g")),o=(new RegExp("^"+e+"*,"+e+"*"),new RegExp("^"+e+"*([>+~]|"+e+")"+e+"*"),new RegExp(e+"|>"),new RegExp(":((?:\\\\[\\da-fA-F]{1,6}[\\x20\\t\\r\\n\\f]?|\\\\[^\\r\\n\\f]|[\\w-]|[^\0-\\x7f])+)(?:\\((('((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\")|((?:\\\\.|[^\\\\()[\\]]|\\[[\\x20\\t\\r\\n\\f]*((?:\\\\[\\da-fA-F]{1,6}[\\x20\\t\\r\\n\\f]?|\\\\[^\\r\\n\\f]|[\\w-]|[^\0-\\x7f])+)(?:[\\x20\\t\\r\\n\\f]*([*^$|!~]?=)[\\x20\\t\\r\\n\\f]*(?:'((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\"|((?:\\\\[\\da-fA-F]{1,6}[\\x20\\t\\r\\n\\f]?|\\\\[^\\r\\n\\f]|[\\w-]|[^\0-\\x7f])+))|)[\\x20\\t\\r\\n\\f]*\\])*)|.*)\\)|)"),new RegExp("^"+t+"$"),{ID:new RegExp("^#("+t+")"),TAG:new RegExp("^%("+t+")"),SECTION:new RegExp("^$("+t+")"),CLASS:new RegExp("^\\.("+t+")"),ATTR:new RegExp("^"+n)});new RegExp("\\\\[\\da-fA-F]{1,6}"+e+"?|\\\\([^\\r\\n\\f])","g");return{parse:function(e,t){var n,r=[];return null!=e&&""!=e&&e.split(",").forEach(function(e){for(var t in e=e.replace(i,""),o)if(n=o[t].exec(e)){r.push({type:t,value:n.shift(),id:n.shift().toLowerCase()});break}}),r}}}(),c.prototype={exec:function(t){if(0===this.items.length||!t)return null;if(1===this.items.length&&t)return t(this.items[0]);if(1<this.items.length&&t){var n={};return this.items.forEach(function(e){n[e.getName()]=t(e)}),n}},push:function(e){this.items.push(e)},get first(){return 0<this.items.length?this.items[0]:null},get length(){return this.items.length}},t=function(e,o,s){"undefined"==typeof jXrm&&(jXrm={__namespace:!0});function n(e,t){var n=this.attributes=new s,r=this.controls=new s,i=o.parse(e);0<i.length?i.forEach(function(e){switch(e.type){case"ID":n.push(Xrm.Page.getAttribute(e.id)),r.push(Xrm.Page.getControl(e.id))}}):console.log("Invalid selector.")}return jXrm=function(e,t){return new n(e,t)},jXrm.fn0=n.prototype={},jXrm.fn=jXrm.prototype={version:"0.02"},jXrm.enum={},jXrm}(0,e,c),n={AlertOpts:{width:450,height:150},ConfirmOpts:{width:450,height:200}},(i=t).context={getUserId:function(){return l().getUserId()},getUserName:function(){return l().getUserName()},getUserRoles:function(){return l().getUserRoles()},getClientUrl:function(){return g().getClientUrl()},get isOffline(){return g().client.isOffline()}},function(e,t){t.extend(e.enum,{RequiredLevel:{None:"none",Required:"required",Recommended:"recommended"},SubmitMode:{Always:"always",Never:"never",Dirty:"dirty"}});t.toObject(e.fn0,["getType|getAttributeType|a|1","isDirty|getIsDirty|a|1","isPartyList|getIsPartyList|a|1","isValid||a|1","maxLength|getMaxLength|a|1","getRequiredLevel||a|1","setRequiredLevel||a","required|setRequiredLevel|a||required","recommended|setRequiredLevel|a||recommended","optional|setRequiredLevel|a||none","getSubmitMode||a|1","setSubmitMode||a","getVisible||c|1","setVisible||c","show|setVisible|c||1","hide|setVisible|c||0","parent|getParent|a|1","getPrivilege|getUserPrivilege|a|1","change|addOnChange|a","removeOnChange||a","fireOnChange||a","getOption||a|1","getOptions||a|1","disable|setDisabled|c||1","enable|setDisabled|c||0","addCustomFilter||c"]),t.extend(e.fn0,{val:function(t,n){return void 0===t?this.attributes.exec(function(e){return e&&e.getValue?e.getValue():null}):(this.attributes.exec(function(e){e&&e.setValue&&e.setValue(t),!0===n&&e.fireOnChange()}),this)},focus:function(){return this.controls.first&&this.controls.first.setFocus&&this.controls.first.setFocus(),this},toggleVisible:function(){return this.controls.exec(function(e){e&&e.setVisible&&e.setVisible(!e.getVsible())}),this},on:function(e,t){}})}(t,r={extend:function(e,t){"function"!=typeof Object.assign&&(Object.assign=function(e,t){"use strict";if(null==e)throw new TypeError("Cannot convert undefined or null to object");for(var n=Object(e),r=1;r<arguments.length;r++){var i=arguments[r];if(null!=i)for(var o in i)Object.prototype.hasOwnProperty.call(i,o)&&(n[o]=i[o])}return n}),Object.assign(e,t)},toObject:function(t,e){return t=t||{},e.forEach(function(e){if(null!==e){var r=e.split("|");r[1]||(r[1]=r[0]),t[r[0]]=function(){for(var e="a"===r[2]?this.attributes:this.controls,t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];if(r[4]&&(t[0]="1"===r[4]||"0"!==r[4]&&r[4]),e)return r[3]?e.exec(function(e){return e&&e[r[1]]?e[r[1]].apply(e,t):null}):(e.exec(function(e){e&&e[r[1]]&&e[r[1]].apply(e,t)}),this)}}}),t}}),u=n,(a=r).extend(o=t,{alert:function(e,t,n,r){var i="string"==typeof e?{text:e}:e,o=u.AlertOpts;a.extend(o,r),Xrm.Navigation.openAlertDialog(i,o).then(t,n)},confirm:function(e,t,n,r,i){var o="string"==typeof e?{text:e}:e,s=u.ConfirmOpts;a.extend(s,i),Xrm.Navigation.openConfirmDialog(o,s).then(function(e){e.confirmed&&(t?t():n&&n())},r)},openForm:function(e,t,n,r,i,o){var s={entityName:e,entityId:t};o&&a.extend(s,o),Xrm.Navigation.openForm(s,n).then(r,i)},openFile:function(e,t){Xrm.Navigation.openFile(e,t)},openUrl:function(e,t){Xrm.Navigation.openUrl(e,t)},openWebResource:function(e,t,n){Xrm.Navigation.openWebResource(e,t,n)}}),r.extend(s=t,{save:function(e,t){return Xrm.Page.data.save().then(e,t),this},refresh:function(e,t,n){return Xrm.Page.data.refresh(e).then(t,n),this},addOnLoad:function(e){return Xrm.Page.data.addOnLoad(e),this}}),f=t,window.jXrm=f}();